---
title: "Version 6.43"
date: 2023-03-01T18:15:26+02:00
draft: false
weight: 88
---

[OPEN PDF](https://storage.googleapis.com/twc-pedia-prod-bucket/pdf/relguides/CHQ%20Release%20Guide%20Version%206.43.121.0.pdf)

## Settings

### Employee Benefit Program

`Build 6.43.113.0: PRO-13686`

As of version 6.43.113.0, Teamwork Commerce introduces Employee Benefit Program (EBP) discount functionality.

#### Purpose

Employee Benefit Program is utilized to provide a flexible system of discounts to customers marked as employees.

Often, the retailer wants its employees to wear items to showcase the brand. The retailer may offer the store associate a budget amount each month, for example, to purchase items at a discount provided through a promotion, employee pricing, or manual/global discounts. When an employee purchases items with their employee discount, the EBP requires an employee/customer account on the receipt to prevent fraud.

#### How EBP works

Each employee has an employee/customer record. That record is assigned to an Employee Benefit Program. 

{{% notice info %}}
**What is employee/customer record?**  
The employee/customer record is a customer record with the checked **employee** setting under `sales > customers > list > [selected customer] > general`.
{{% /notice %}}

The EBP sets up the Periodic Budget along with its rules. There is no limit to the number of EBPs that can be defined. In other words, different employees can be assigned to different programs. At the same time, one employee may have only one EBP assigned.

For example, the retailer may set up the **MGR** benefit program for managers, providing a budget of **$300**; simultaneously, to motivate their associates, the retailer may initialize the ASOC benefit program with a **$250** budget.

The EBPs are set up in CHQ each with their own unique budget and benefit method.

- period amount
- balance
- period
- period reset

A budget of the EBP is defined by a *period amount* that is a money limit an employee may use during the program *period* after the employee pricing, discount, or promotion applying.

{{% notice info %}}
The EBP can have an unlimited budget or a limited budget. The latter helps avoid employee fraud, like re-selling products to customers.
{{% /notice %}}

The EBP *balance* within a budget is the remaining balance for the assigned Employee Benefit Program. CHQ calculates the available allowance based on the assigned EBP and previous sales within the period.

{{% notice note %}}
A *zero balance* reflects no additional discount is permitted. The *blank balance* means the unlimited period amount.
{{% /notice %}}

The EBP *period* determines the frequency of the *balance* to be reset, for example, weekly, monthly, or annually.

The benefit program *reset* is the exact date the program resets the balance defined in the EBP. Any remaining balance is discarded.

{{% notice note %}}
Example: on Nov 1st, 2022, the EBP limit of $500.00 will be set as the new balance available for the employee/customer.
{{% /notice %}}

##### How the available EBP balance is calculated

CHQ calculates the current balance as the EBP limit (period amount) minus the value of all EBP sales within the period for the related employee/customer.

This EBP sales value is the sum of previous sales before additional discount settings on the EBP program. Verified returns for employee sale items may be added back to the EBP balance depending on settings.

For example: if the employee has a limit of $500 and has spent $200 (before the discounted value), the remaining balance is $300.

Items marked as not discountable sold on employee sales count towards the total, reducing the balance. The receipt total, including tax, fees, etc., affects the balance calculation.

{{% notice tip %}}
A retailer should increase the program's budget to cover the value of taxes, fees, etc.
{{% /notice %}}

If the Employee Benefit Program has been changed in the middle of the program period, the balance changes accordingly to the adjusted limit, but the calculation formula remains the same.

For example:

- the employee started the EBP period with the period amount of $500
- the employee purchased $100 of value (before the discount) during the current EBP period
- the employee was promoted to manager with an EBP amount of $1000
- the employee's EBP balance will display $900.

#### Changes in security rights

We’ve added the following new security rights:

**APPLICATION**|**AREA**|**RIGHT**|**DESCRIPTION**| 
:-----------|:-----------|:-----------|:-----------|
POS|Sales Receipt| Allowed to add employee/customer| Allows the user to add an employee/customer record to the sales receipt|
CHQ|Customer| Allowed to edit Employee flag and EBP| Allows the user to mark a customer record as an Employee and change the spending group|
CHQ| Sales Receipt|Add/Edit manual disc for employee/customer |Allows the user to add and edit a manual item or global discount on sales receipt with customer flagged as employee|

At the same time, we’ve removed the **Allowed to apply employee discount** POS security right.

{{% notice tip %}}
Security rights can be found under `settings > security > roles > rights`.
{{% /notice %}}
 
#### Managing EBPs

Reviewing, creating new and editing existing EBPs are possible in CHQ under `settings > company settings > credit & reward platform > employee benefit program`:
{{% gimg src="V6.43 CHQ Release Guide/6.43_chq_EBP1.jpg" width="700px"%}}

##### Reviewing existing EBPs

In the **employee benefit program** area, the following high-level information about EBP records is available:

- **name**: EBP name
- **fiscal zone**: the fiscal zone this EBP is applied to
- **period type**: used to determine the program period and reset date
- **program type**: the type of discount the employee receives – “promotion only”, “discount”, or “price level”
- **period amoun**t: EBP budget
- **inactive**: indicates if the respective EBP is active or not
{{% notice note %}}
The **period type** consists of the calendar used in the Employee Benefit Program and the EBP period separated. These two values are separated by a dash. For example, `gregorian - monthly` or `retail calendar - monthly`.
{{% /notice %}}

It is possible to **filter** EBPs based on their active/inactive status.

##### Creating and editing an EBP

1. In CHQ, go to `settings > company settings > credit & reward platform > employee benefit program`.
2. To create a new EBP, click **new** at the top above the grid. To edit an existing program, double-click a respective record in the list.
3. In the **new employee benefit program** dialog that opens configure the following:
{{% gimg src="V6.43 CHQ Release Guide/6.43_chq_EBP_2.jpg" width="450px"%}}
In the **general** section:

- **name**: Employee Benefit Program’s name
{{% notice note %}}
Please consider that the name of the Employee Benefit Program must be unique and 512 characters max.
{{% /notice %}}
- **inactive**: check to deactivate EBP
- **fiscal zone**: the fiscal zone EBP is applied to
{{% notice note %}}
Only one fiscal zone can be applied per EBP. The employee must be added to the sale in a zone chosen as a fiscal zone for EBP.
{{% /notice %}}
- **program type**: the type of discount the employee receives. Three options are available:
    - `promotion only`: no discount or price level discount will be given, only those promotions that have this EBP assigned on the promotion. 
    - `discount`: a discount to be applied as the item discount on the sales receipt, which defines the discount percentage.  
Selecting `discount` adds the discount reason field where you need to select the respective reason from a preconfigured list.
    - `price level`: a price level to be applied as the global price level to the sales receipt.  
Selecting `price level` adds the price level field where you need to select the respective price level from a preconfigured list.
- **period type (calendar)**: used to determine the program period and reset date. Can be one of the following:
    - `gregorian`: allows for selecting standard calendar options for program period and reset date.
    - `retail calendar`: uses the defined retail calendar to determine the reset dates.
- **period**: depending on the previous setting can be
    - if `gregorian` is selected:
        - `monthly`: program resets on the first of the month, each month (default).
        - `quarterly`: program resets on the first day of the month of each quarter (Jan 1, Apr 1, Jul 1, Oct 1).
        - `annually`: program resets each Jan 1st.
    - if `retail calendar` is selected:
        - `weekly`: resets on the first day of each of the weekly periods.
        - `monthly`: resets on the first day of the month as the month is defined in the retail calendar year.
        - `annually`: resets on the first day of the 5-4-4 calendar year.
- **period amount**: the maximum amount that can be spent and receive a discount. The minimum value is `0.01`, while the maximum is `999,999,999.99`. A blank field means an employee can purchase as much as they want with the selected discount type.
<br>
<br>
    In the **options** section:
<br>
<br>
- **locations**: choose where EBP can be applied. By default `any` is used. In that case, the program is spread on every active location within the configured fiscal zone. Clicking **edit** on the right brings up the standard **select locations** dialog and mark the preferred locations
- **allow price level changes**: select to let the user change the price level on the sale or item level
- **allow price breaks**: select to let the sales engine apply price breaks at the item level
- **allow manual price changes**: select to let the user make manual price changes via the Price Override UI on the **change price** tab at the receipt or line item level
- **allow line/global discounts**: select to let the sales engine apply eligible line/global discounts
- **return balance**: choose when returns are added back to the EBP balance. Can be one of the following:
    - `never`: an employee can return discounted items, but the balance used is not returned.
    - `current period only`: returns are added back to the EBP balance within the current EBP period only.
    - `anytime`: returns are added back to the EBP balance and may exceed the maximum.

#### Making EBP allowed for Promotion Engine

We’ve added the **allowed employee benefit programs** option in CHQ Promotion Engine, under `sales > promotion engine > new > [selected type of promotion] > options`:
{{% gimg src="V6.43 CHQ Release Guide/6.43_chq_EBP3.jpg" width="600px"%}}

Selecting this option brings up the **EBPs** field. In **EBPs**, the programs selected for this promotion display. If `any` displays, then all the EBPs are allowed for this promotion.

To select EBPs, click **edit** on the right.

#### Adding employee to EBP

In CHQ, under `sales > customers > [required customer record]`, on the **general** tab, we’ve added a new section – **employee**:
{{% gimg src="V6.43 CHQ Release Guide/6.43_chq_EBP_4.jpg" width="600px"%}}

To mark this customer as employee, select the **employee** checkbox.
{{% notice note %}}
Please be advised that a user must have the Allowed to edit Employee flag and EBP security right to configure.
{{% /notice %}}

- **benefit program**: select the required EBP for this customer/employee
- **benefit program balance**: shows the remaining balance and period amount for the assigned EBP. For example: `$234.22` of `$1.000.00`
- **benefit program reset**: shows the date the balance defined in the current EBP resets

#### Changes in v6 App Designer

In CHQ, under `settings > company settings > V6 App designer`, we've added the **Employee** pre-defined group to the following areas:

- `iPad > Customer > Customer Form`
- `iPad > Sales Receipts > Customer Tab`

#### New setting for future DETZ support

We've added the employee sales section at the bottom of the `settings > sales > sales documents`. In this section, we've provided the **require MYDETZ QR code scan for employee sale** option for future use with the DETZ functionality.

{{% notice info %}}
**What is DETZ and MYDETZ?**  
**DETZ** is a cloud-based system for employees’ secure registration and authentication.  
My Details (**MYDETZ**) is a Teamwork Commerce mobile app that allows associates (employees) to register their information in a single location, then share that information with specific brands, including their employer. Additionally, this app allows for generating a QR code based on employee details. This QR code is then used to log in to POS PRO.
{{% /notice %}}

Currently, users may manually search for an employee/customer record and add it to the transaction. In the future, this will require MYDETZ QR Code scanning if the require MYDETZ QR code scan for employee sale setting is on.

#### See also

- [V6.43 POS Release Guide](https://twdocs.netlify.app/userdoc/pos/relguides/6.43_mobile_rel_guide/ "POS Release Guide Version 6.43")
- [Cloud HQ User Manual: Sales](https://twdocs.netlify.app/userdoc/chq/manuals/ "CHQ Manual Version 6")
- [Cloud HQ User Manual: Settings](https://twdocs.netlify.app/userdoc/chq/manuals/ "CHQ Manual Version 6")

### V6 App Designer: Restructured Customer Search for POS PRO

`Build 6.43.113.0: PRO-14936`

We've added the **Customer Search Fields** section to the `settings > company settings > v6 App Designer > Point of Sale v6 > iPad > Customer area` of the **v6 App Designer** for POS PRO:
{{% gimg src="V6.43 CHQ Release Guide/6.43_chq_customer1.jpg" width="600px"%}}

With this new section, users can define the fields (parameters) to be available in POS PRO to search by and the order in which they appear.

**Example: Customer search in POS PRO**
{{% gimg src="V6.43 CHQ Release Guide/6.43_chq_customer2.jpg" width="600px"%}}

{{% notice note %}}
This user-defined search structure will be used in POS in both the **Customer** area and the **Customer** tab of the **Sales Receipt** area.
{{% /notice %}}

Currently, the fields available to search customers by are:

- All
- Name
- Phone
- Email
- Member Code
- Credit Memo #
- External ID

**All**, **Name**, **Phone**, and **Email** are available by default for new installations. To add additional search fields, drag the corresponding items from the **available fields** section to **layout**.

To change the order of the customer search tabs, drag the corresponding items up or down under **layout** of V6 App Designer.

{{% notice note %}}
The **All** option cannot be removed from the POS PRO layout in the v6 App Designer.
{{% /notice %}}

#### See also

- [V6.43 POS Release Guide](https://twdocs.netlify.app/userdoc/pos/relguides/6.43_mobile_rel_guide/ "POS Release Guide Version 6.43")
- [Cloud HQ User Manual: Settings](https://twdocs.netlify.app/userdoc/chq/manuals/ "CHQ Manual Version 6")

### HR Code added to employee records

`Build 6.43.113.0: PRO-13665`

We've added the **HR Code** field to user records under `chq > settings > security > users > [selected user] > user info`:
{{% gimg src="V6.43 CHQ Release Guide/6.43_chq_HRcode_1.jpg" width="400px"%}}
{{% notice note %}}
The **HR Code** value must be unique and 128 characters max.
{{% /notice %}}

The **HR Code** identifier will be used with Teamwork MYDETZ app to verify an MYDETZ record is an employee.
{{% notice info %}}
**WHAT IS MYDETZ?**  
My Details (**MYDETZ**) is a Teamwork Commerce mobile app that allows associates (employees) to register their information in a single location, then share that information with specific brands, including their employer. Additionally, this app allows for generating a QR code based on employee details. This QR code is then used to log in to POS PRO.
{{% /notice %}}

#### Extended JSON-based Employee export/import

As a part of this update, we’ve added the **HRCode** field to JSON-based Employee Export and Import APIs.

#### See also

[Cloud HQ User Manual: Settings](https://twdocs.netlify.app/userdoc/chq/manuals/ "CHQ Manual Version 6")

### Offline payments: Refunding Sales Order deposits

`Build 6.43.113.0: PRO-14002`

As of version 6.43.113.0, we’ve added the capability to refund sales order deposits when the original payment method is `offline` or `offline credit card`. Additionally, this enhancement applies to the cases where the original payment method is a credit card with an integrated credit card processor not supported by CHQ (for example, Banorte, Clover, and Global Payments).

This resulted in adding the **order cancellation** area with the **refund to** dropdown menu to the respective payment method dialogs under `chq > settings > sales > payment methods`:
{{% gimg src="V6.43 CHQ Release Guide/6.43_chq_refund_1.jpg" width="400px"%}}

In **refund to**, users can choose between `credit memo` (default) and `offline payment`.

{{% notice note %}}
If the payment type is `credit card`, then the new setting in the **order cancellation** area is labeled **PSP not supported - refund to** instead of **refund to**.
{{% /notice %}}

#### See also

[Cloud HQ User Manual: Settings](https://twdocs.netlify.app/userdoc/chq/manuals/ "CHQ Manual Version 6")

### Restrict Customer’s Purchase History in POS to fiscal zone

`Build 6.43.113.0: PRO-15697`

We’ve added the **display device fiscal zone only** setting to allow the retailer to restrict the registered customer sales history shown in POS PRO to the current fiscal zone of the device.

{{% notice note %}}
Prior to version 6.43.113.0, the POS PRO user could only view the customer-specific full purchase history, regardless of the fiscal zone/country the sale was made.
{{% /notice %}}

#### How to control sales history view

To restrict customers’ sales history view in POS to the user’s device fiscal zone:

1. In CHQ, go to `settings > sales > POS settings`.
2. In the **sales history** area, select the **display device fiscal zone only** checkbox:
{{% gimg src="V6.43 CHQ Release Guide/6.43_chq_fz_1.jpg" width="600px"%}}
3. **Save** your changes.

{{% notice note %}}
In POS PRO, this setting affects:

- the **Customer history** list view
- the **History** list view in the **Sales** area
- **Find Receipt** under `Sales Receipt > Options` 
- the **Review** list view in the **Sales Receipts** area
{{% /notice %}}

#### See also

- [V6.43 POS Release Guide](https://twdocs.netlify.app/userdoc/pos/relguides/6.43_mobile_rel_guide/ "POS Release Guide Version 6.43")
- [Cloud HQ User Manual: Settings](https://twdocs.netlify.app/userdoc/chq/manuals/ "CHQ Manual Version 6")

## Sales 

### Searching Virtual Gift Cards by recipients’ names and emails

`Build 6.43.113.0: PRO-11444`

We’ve made it possible to search for Virtual Gift Cards (VCG) by the recipient’s name and email address. To achieve that, we’ve added the following two fields to the Gift Card **filter** section:

- **VGC send to email**: the email of the person who received the Virtual Gift Card
- **VGC send to name**: the name of the person who received the Virtual Gift Card

#### Purpose

The possibility to search by the recipient’s name or email may come in handy if the giftee loses or misplaces the information on the Virtual Gift Card. In such a situation, the support worker can locate the original VGC more easily.

#### Where to search for the Virtual Gift Card

1. Go to `chq > sales > gift cards`.
2. In the **filter** section on the right, input the recipient’s name or the email address in the **VGC send to name** or the **VGC send to email** fields, respectively.
{{% gimg src="V6.43 CHQ Release Guide/6.43_chq_VGC_1.jpg" width="600px"%}}
{{% notice tip %}}
In filters, you can start typing to search for the required entity.
{{% /notice %}}
3. Click the magnifying glass icon under **filter**.
{{% notice note %}}
The number in brackets indicates the quantity of the VCGs meeting the search criteria. The magnifying glass icon is clickable only when the number exceeds zero.
{{% /notice %}}
4. In the **gift cards** list view that opens, explore the search results.

#### See also

[Cloud HQ User Manual: Sales](https://twdocs.netlify.app/userdoc/chq/manuals/ "CHQ Manual Version 6")

### Updated Gift Card retrieval

`Build 6.43.113.0: PRO-13024`

At the backend, we've updated the SQL procedure that allows for optimized retrieval of Gift Cards.

### Settings for simplified multi-promo returns

`Build 6.43.113.0: PRO-14196, PRO-15880`

We’ve extended and updated CHQ settings to respect changes made in POS PRO regarding simplification of returns if Sales Receipts contain more than one promotion.
{{% notice note %}}
A single item on a Sales Receipt cannot be a part of two different promo sets, except for the **Spend More, Get More** promotion, which can be added on top of the other promotion types. Whether the item can be returned separately or as a promo set depends on the first promo and never on the **Spend More, Get More** promotion.
{{% /notice %}}
{{% notice info %}}
**WHAT IS PROMO SET?**  
A promo set is a list of items forming a single promotion instance on a Sales Receipt. The receipt can have more than one instance of the same promotion and, accordingly, more than one 
promo set.
{{% /notice %}}

This enhancement aims at reducing the level of effort needed for managing the return process as well as training users effectively.

#### Spread promo discount for Buy X, Get Y

We’ve added the **spread promo discount** setting under `chq > sales > promotion engine > new/edit > general`:
{{% gimg src="V6.43 CHQ Release Guide/6.43_chq_disc1.jpg" width="600px"%}}

The **spread promo discount** option is visible only for the **Buy X, Get Y** promo type. 

If the **spread promo discount** option is selected, the user can return individual items within a **Buy X, Get Y** promo set, regardless of the Promo Engine requirement to return all items within a promo set. In this case the calculated promotion discount (PromoAmount) is spread among buy and get promo lines.

{{% notice note %}}
The PromoAmount is spread proportionally to the formula “PriceAfterItemDiscount * PromoLineQty”. Here the PriceAfterItemDiscount is the price after all manual item and coupon item discounts, while PromoLineQty is the corresponding promo line quantity.
{{% /notice %}}

#### Updates to the promo return option

We’ve introduced the following two changes in **grouped promo items partial return** that displays if **promo returns** is selected under `chq > sales > promotion engine > [your promotion] > options`:

1. We’ve changed the name of the **require all items returned together** option to **require all items from promo set are returned together**.
2. We’ve extended the dropdown menu with the `allow` option. If this option is selected, the user can return the items that are part of a promotion set without any warning.
{{% gimg src="V6.43 CHQ Release Guide/6.43_chq_promo1.jpg" width="600px"%}}

{{% notice warning %}}
The above changes do not apply to the sale price promo type. 
{{% /notice %}}

#### Removed return restrictions for Spend More, Get More

The **promo returns** option has been removed for the **Spend More, Get More** promo type under `chq > sales > promotion engine > [your promotion] > options`.  
Now, the user can return items sold as a part of such promo sets with no restriction or warning (as long as other restrictions such as, for example, Final Sale, do not apply).

#### See also

- [V6.43 POS Release Guide](https://twdocs.netlify.app/userdoc/pos/relguides/6.43_mobile_rel_guide/ "POS Release Guide Version 6.43")
- [Cloud HQ User Manual: Sales](https://twdocs.netlify.app/userdoc/chq/manuals/ "CHQ Manual Version 6")

### Updated logic for Verified Return calculation

`Build 6.43.113.0: PRO-15411`

As of version 6.43.113.0, we've updated the logic of how Verified Returns are calculated at the backend. 

Now, instead of copying final ReceiptItem values to the newly created return item, we copy all values from the original item and adjust extended amounts based on the returned quantity and block any further recalculations (except for adding or removing charges).

#### See also

[V6.43 POS Release Guide](https://twdocs.netlify.app/userdoc/pos/relguides/6.43_mobile_rel_guide/ "POS Release Guide Version 6.43")

### Searching by customers’ First and Last Name

`Build 6.43.113.0: PRO-15407`

We’ve added the capability to search various entities in CHQ by customers’ first and last names as well as searching for customers by these parameters.

#### Customer first and last name filters

The **customer first name** and **customer last name** filters are now available in the following sections of CHQ:

- `sales > order management`
- `sales > ship memos`
- `sales > RMA orders`
- `sales > returns manager`
- `sales > sales receipts`
- `sales > gift cards`
- `sales > credit memos`
- `sales > coupons`

Similar filters were added to `sales > customers`, where they are named **first name** and **last name**.

#### Search to add a customer by first/last name

As a part of this update, we’ve provided separate input areas for customer’s first and last names (if the `name` option is selected) in the **search to add customer** field of the following dialogs:
{{% gimg src="V6.43 CHQ Release Guide/6.43_chq_name1.jpg" width="450px"%}}

- `sales > order management > new > customer`
- `sales > gift cards > list > new/edit > general`
- `sales > coupons > list > new > general`
- `sales > customers > list > merge customers`
- `inventory > reserve orders > list > new/edit > general`

Similar update was introduced to:

- the **customer for replenishment** field under `settings > location settings > locations/location settings > new/edit > transfers`:
{{% gimg src="V6.43 CHQ Release Guide/6.43_chq_name2.jpg" width="450px"%}}
- the **search to add** field of the **customer search** dialog throughout CHQ:
{{% gimg src="V6.43 CHQ Release Guide/6.43_chq_name3.jpg" width="450px"%}}

#### See also

- [Cloud HQ User Manual: Sales](https://twdocs.netlify.app/userdoc/chq/manuals/ "CHQ Manual Version 6")
- [Cloud HQ User Manual: Settings](https://twdocs.netlify.app/userdoc/chq/manuals/ "CHQ Manual Version 6")

### Exchange Order shipping information in RMA Order

`Build 6.43.113.0: PRO-14862`

We've added the capability to define Exchange Order shipping information in RMA Orders. This resulted in adding new settings at the RMA Order item level as well as in the **create RMA order** dialog.

#### Shipping settings at RMA Order item level

In CHQ, under `sales > RMA orders > list > [selected RMA Order] > edit > items > [selected item] > edit` the following new sections have been added:

- **exchange**
- **exchange order delivery**
- **exchange order - ship to**

{{% gimg src="V6.43 CHQ Release Guide/6.43_chq_rma_1.jpg" width="500px"%}}

##### The exchange section
{{% notice note %}}
Please be advised that the **exchange** section is visible if the RMA Order line is linked to a Sales Order.
{{% /notice %}}

The **exchange** section contains the **exchange PLU** field that was moved from the **general** area.

To choose an item by PLU or clear the selection, use the **select/remove** button on the right.

##### The exchange order delivery section
{{% notice note %}}
Please be advised that the **exchange order delivery** section is visible if the **exchange PLU** field in the **exchange** section is populated.
{{% /notice %}}

In the **exchange order delivery** area, the following options are available:

- **use delivery method from original order**
- **ship to customer**

If the **ship to customer** option is selected, the **shipping method** dropdown menu appears. This menu allows the user to select any available shipping method for this exchange. 

{{% notice note %}}
The settings in this area are editable if:

- the user has the **RMA Orders - Add Edit** security right
- **returned qty** is equal to `0`
- **qty** minus **cancelled return qty** is greater than `0`
- the dialog is not in read-only mode
- RMA Order is not archived
{{% /notice %}}

##### The exchange order - ship to section
{{% notice note %}}
Please be advised that the **exchange order - ship to** section is visible if the **exchange PLU** field in the **exchange** section is populated and the **ship to customer** option is selected in the **exchange order delivery** section.
{{% /notice %}}

In the **exchange order - ship to** section, the non-editable **exchange order ship to address** info displays.

To select the address, use the **change address** button on the right that opens the **change address** dialog.

#### Shipping settings in the create RMA order dialog

The same **exchange**, **exchange order delivery**, and **exchange order - ship to** sections with the same settings as described above are added to the **create RMA order** dialog.
{{% notice tip %}}
The **create RMA order** dialog can be accessed from:

- the **customer** dialog: `sales > customers > list > [selected customer] > edit > sales > [selected item] > create RMA Order > create RMA Order`
- the **sales order** dialog: `sales > order management > view/edit > [selected sales order] > items > [selected item] > actions > create RMA Order`
{{% /notice %}}

#### JSON-based RMA Order Import/Export APIs

We've added the **exchange order delivery**, **exchange order shipping method**, and **exchange order ship to info** fields to the JSON-based RMA Order Import and Export APIs at the item level.

#### See also

[Cloud HQ User Manual: Sales](https://twdocs.netlify.app/userdoc/chq/manuals/ "CHQ Manual Version 6")

### French fiscalization: Gift Card sales excluded from Grand Totals

`Build 6.43.121.0: PRO-16320`

We’ve excluded Gift Cards sales from Grand Totals calculation. This has been done to align with French fiscal regulations.

## Services

### Storing device serial number in CHQ

`Build 6.43.113.0: PRO-14828`

As of 6.43.113.0, the device serial number captured by Teamwork Commerce Certificate App is stored in **device serial number** under `chq > services > device controller > [selected device] > general`:
{{% gimg src="V6.43 CHQ Release Guide/6.43_chq_dtn_1.jpg" width="500px"%}}

This allows retailers to receive the device serial number in CHQ to help them keep track of which devices are active in locations.

#### See also

- [V6.43 POS Release Guide](https://twdocs.netlify.app/userdoc/pos/relguides/6.43_mobile_rel_guide/ "POS Release Guide Version 6.43")
- [Cloud HQ User Manual: Analytics & Services](https://twdocs.netlify.app/userdoc/chq/manuals/ "CHQ Manual Version 6")

## Other Enhancements

### AccountNumber added to the JSON-based Simple Receipt Export API

`Build 6.43.113.0: PRO-16293`

We’ve extended JSON-based Simple Receipt Export API by the **AccountNumber** field at the ReceiptItem level. When a customer buys a Gift Card, the ReceiptItem is created where the ItemId is the ID of the service item. The number of that Gift Card, in turn, is stored in the ReceiptItem.AccountNumber field.

### Cost Ledger optimization

`Build 6.43.113.0: PRO-15391`

At the backend, we've updated Cost Ledger by removing obsolete tables and views.

### JSON-based Employee Export API: Added RoleID

`Build 6.43.113.0: DS-4301`

We’ve added the **RoleID** field to the **EmployeeRoles** array of the JSON-based Employee Export API response. The **RoleID** contains the identifier of the role name assigned to the employee.

### New tax-related JSON-based APIs

`Build 6.43.113.0: DS-3345`

We’ve added the following new JSON-based tax-related APIs:

- JSON-based Tax Jurisdiction Import API 
- JSON-based Tax Zone Import API
- JSON-based Tax Zone Line Import API
- JSON-based Tax Category Import API
- JSON-based Tax Detail Import API

These JSON-based APIs replace the previously existing XML-based APIs.

### Extended JSON-based Sales Receipt Export and Sales Receipt Full Export APIs: FiscalNo and FiscalDate 

`Build 6.43.113.0: DS-4711`

We’ve extended the JSON-based Sales Receipt Export and Sales Receipt Full Export APIs with the **FiscalNo** and **FiscalDate** fields at the receipt level.

### French fiscalization: Electronic signature validation fails

`Build 6.43.121.0: DS-5121`

We've fixed the issue where customer receipt and invoice signature validation failed due to incorrect sorting of *Amounts (tax incl.) broken down per VAT rate* (a signature component) that occurred during that signature generation.

{{% notice info %}}
Electronic signature is a unique value that, in accordance with French fiscal regulations, must be assigned to certain entities (for example, customer receipts and invoices). Electronic signature is generated based on that entity’s data and also includes a signature from the previous entity of that type.

To validate an electronic signature, in CHQ:
1. Go to `settings > company settings > countries/regions`.
2. Click to select **France** and click **fiscal settings** above the grid.
3. On the **fiscal** tab of the **FR - fiscal settings** dialog, next to **test dialog**, click **open**.
4. In the **signature validation** section of **test dialog**, select the required **entity type** and fill out the entity ID field (**sales receipt universal #**, **primary key (GUID)**, or **invoice universal #**) with the respective value.
5. Click **check**.
{{% /notice %}}

## Issue Resolutions

### Reversing Purchase Receipts with linked finalized Matching Memos via import

`Build 6.43.113.0: DS-1915`

**Issue**  
Prior to version 6.43.113.0, it was possible to reverse an existing Purchase Receipt via import even if that Purchase Receipt was linked to a finalized Matching Memo.
{{% notice note %}}
An existing Purchase Receipt can be reversed via Purchase Receipt import under `chq > purchasing > purchase receipts > import`. For reversing, former receipt # in the uploaded Purchase Receipt template must be populated with the number of the existing Purchase Receipt. 
{{% /notice %}}

**Resolution**  
The issue has been fixed. Now, as expected, on attempting to reverse a Purchase Receipt with a finalized Matching Memo linked, the `Unable to reverse the purchase receipt. The purchase receipt is already linked to a finalized invoice matching memo` error message displays.

### JSON-based Sales Receipt Export API: OriginalLocation is missing for Verified Returns

`Build 6.43.113.0: DS-4724`

We've fixed the issue where the JSON-based Sales Receipt Export API response did not contain the **OriginalLocation** field for Verified Returns.

The **OriginalLocation** is the identifier of the location where the item was originally purchased.

### Promo Type and ItemType fields missing in the JSON-based Sales Receipt Full Export API response

`Build 6.43.113.0: DS-5003`

**Issue**  
Prior to 6.43.113.0, the information on **Type** or **ItemType** of the applied promotion was missing in the JSON-based Sales Receipt Full Export API response.

**Resolution**  
The issue has been fixed. The ItemType field appears in the API response only when the **Buy X, Get Y** promotion has been applied.  
The promotion **Type** field displays in the API response when any promotion type is applied. 

### Incorrect running balance value for gift card transactions

`Build 6.43.113.0: DS-4754`

We’ve fixed the issue where the **running balance** value could be incorrectly calculated for Gift Cards transactions. This happened as a result of incorrect calculation of GiftCardBalance in the svs.GiftCardTransaction.Amount table for the corresponding transaction.

### Incorrect original transfer qty value in a supplemental transfer

`Build 6.43.113.0: DS-4937`

We’ve fixed the issue where under `chq > inventory > transfer memos > [your Transfer Memo] > items > supplemental transfer`, the **original transfer qty** value incorrectly used the **qty in** value instead of **qty out**.

### Users incorrectly taken to page 1 of the Order Management list view

`Build 6.43.113.0: DS-4899`

We’ve fixed the issue where users were unexpectedly taken to page **1** if they were on any other page of the Order Management **list** view and clicked the **create SM** button with Sales Order(s) selected. In this case, selected Sales Orders had to be in the status that allowed for Ship Memo creation (for example, `accepted`).

### JSON-based Secure Customer Import API call overwrites the OptInLoyaltyProgram field 

`Build 6.43.113.0: DS-4967`

We’ve fixed the issue where, under `chq > sales > customers > [your customer] > membership`, the **loyalty program opt-in** value could be overwritten after executing a JSON-based Secure Customer Import API call. The issue occurred even though the **OptInLoyaltyProgram** field wasn’t included in the API call.

### Webhook not displaying additional coupon information

`Build 6.43.113.0: DS-5037`

We’ve fixed the issue where the coupon-related webhook failed to display additional coupon information (coupon #, type, value, expiration date, membership code, email 1, mobile). 

### The Accept SalesOrder task fails for Sales Orders with Virtual Gift Cards

`Build 6.43.113.0: DS-5016`

**Issue**  
Prior to 6.43.113.0, after importing a Sales Order in the `approved` status with a Virtual Gift Card in it, the respective order could occasionally freeze in the `in review` status under `chq > sales > order management > [your sales order]`.  
As a result, such Sales Order wasn’t accepted by the autoprocess and the Accept SalesOrder task could fail due to the `There are not enough funds to fulfill the order.` error message. However, it was possible to accept this Sales Order manually.

**Resolution**  
The issue has been fixed. Now, Sales Order with a Virtual Gift Card in it is accepted as expected by the autoprocess.

### Payment method not visible for a Sales Order

`Build 6.43.113.0: DS-5010` 

**Issue**  
Prior to 6.43.113.0, the payment method information would be missing for a Sales Order under `chq > sales > order management > [your Sales Order] > payments`. The issue occurred when the payment method used in the Sales Order was an AliPay credit card.

**Resolution**  
The issue has been fixed. Now, the payment method information is available as expected for a Sales Order. 

### Searching for customer fails when creating a new Sales Receipt

`Build 6.43.113.0: DS-4756`

We’ve fixed the issue where searching for a customer record when creating a new Sales Receipt in POS PRO could occasionally fail due to the timeout error.

### Improved logic of exchange RMA Orders auto-processing

`Build 6.43.113.0: DS-4782`

Previously, the auto return process for exchange RMA orders could fail with the `Receipt could not be saved` error message and no further processing of that order took place. 

The issue has been fixed. Now, if this error occurs, the auto return process keeps trying to complete the exchange.

### JSON-based Sales Receipt Export API: Missing the DrawerMemoIdentifier field in API response

`Build 6.43.113.0: DS-4907`

We’ve fixed the issue where the **DrawerMemoIdentifier** field could occasionally be missing in the JSON-based Sales Receipt Export API response. This happened when the **DrawerMemoIdentifier** setting was set to `WorkstationNum` or `WorkstationName` in requests.

### Code optimizations to eliminate deadlocks

`Build 6.43.113.0: DS-4676`

We’ve optimized code on the server side to reduce the possibility of deadlocks, for example, during transfer processing or mobile app synchronization.

### Inability to initialize POS PRO

`Build 6.43.113.0: DS-4390`

We’ve fixed the issue where initializing POS PRO could occasionally fail due to the timeout error.

## Impacted Areas

Teamwork Commerce PRO Suite allows for unique client-specific configurations. If the above is your case, we recommend that the areas and workflows listed below be additionally checked to ensure the existing functionality works as expected in conjunction with the newly released features.

{{% notice note %}}
Please be advised that the information below does not include details on the configurations and conditions required for testing the new features. For detailed information, see the respective feature description in this release guide.
{{% /notice %}}

Feature|Impact|
:-----------|:-----------|
Employee Benefit Program|Test workflows related to creating and managing an Employee Benefit Program (EBP).|
V6 App Designer: Restructured Customer Search for POS PRO|In CHQ, define what customer search criteria should display in POS PRO. In POS, check the Recent Customers section from different POS areas.|
HR Code added to employee records|In CHQ, check the availability of the HR Code field.|
Offline payments: Refunding Sales Order deposits|In CHQ, configure your offline payments records. In POS, test workflows related to processing refunds with offline payment methods.|
Restrict Customer’s Purchase History in POS to fiscal zone|In CHQ, enable the display device fiscal zone only setting. In POS, check if only transactions made at locations within the same fiscal zone display in search results and lists of historical transactions.|
Searching Virtual Gift Cards by recipients’ names and emails|In CHQ, use new filters to search for Virtual Gift Cards.|
Settings for simplified multi-promo returns|In CHQ, define how Verified Returns of promo-grouped items should be processed. In POS, test workflows related to performing a Verified Return of an item from a promo group.|
Searching by customers’ First and Last Name|In CHQ, search for customer records by the customers’ first and last names.|
Exchange Order shipping information in RMA Order|In CHQ, test workflows related to defining Exchange Order shipping information in RMA Orders.| 
Storing device serial number in CHQ|In CHQ, check the device serial number under `services > device controller > [selected device] > general`.|

{{% notice warning %}}
WE DO NOT WARRANT AND SHALL NOT BE RESPONSIBLE FOR THE PERFORMANCE OF ANY THIRD-PARTY VENDOR’S PRODUCTS OR SERVICES. ALL SOFTWARE AND HARDWARE IS ACQUIRED SUBJECT TO THE END USER LICENSE AGREEMENT, WARRANTY, AND OTHER TERMS PROVIDED BY THE MANUFACTURER OR SUPPLIER OF SUCH THIRD-PARTY PRODUCT. YOU AGREE TO BE BOUND BY AND COMPLY WITH ANY SUCH MANUFACTURER LICENSE AGREEMENT, WARRANTY, OR OTHER TERMS AND CONDITIONS, AND YOU UNDERSTAND AND AGREE TO LOOK SOLELY TO THE THIRD-PARTY VENDOR OF THE PRODUCT FOR MAINTENANCE AND SUPPORT, INCLUDING BUT NOT LIMITED TO RESOLUTION OF SYSTEM ERRORS, BUGS, PATCHES, HOT FIXES, ETC. YOUR SOLE AND EXCLUSIVE RIGHTS AND REMEDIES WITH RESPECT TO ANY THIRD-PARTY PRODUCT OR SERVICE, INCLUDING RIGHTS AND REMEDIES IN THE EVENT A THIRD-PARTY PRODUCT OR SERVICE GIVES RISE TO AN INFRINGEMENT CLAIM, WILL BE AGAINST THE THIRD-PARTY VENDOR AND NOT AGAINST US.

TO THE MAXIMUM EXTENT PERMITTED BY LAW, WE DISCLAIM ANY AND ALL PROMISES, REPRESENTATIONS, AND WARRANTIES, EXPRESS OR IMPLIED, WITH RESPECT TO THE VERSION OF THE PROGRAM SET FORTH HEREIN, SPECIFICALLY INCLUDING ANY UNDERLYING THIRD PARTY TECHNOLOGIES AND/OR PLATFORMS USED IN CONJUNCTION WITH SAME, MATERIALS AND ANY OTHER DATA, INFORMATION, OR OTHER MATERIAL FURNISHED TO USER HEREUNDER, INCLUDING, WITHOUT LIMITATION, THE CONDITION THEREOF; AND WARRANTIES OF NON-INFRINGEMENT, TITLE, MERCHANTABILITY, OR FITNESS FOR A PARTICULAR PURPOSE OR USE.
{{% /notice %}}

<br>

[OPEN PDF](https://storage.googleapis.com/twc-pedia-prod-bucket/pdf/relguides/CHQ%20Release%20Guide%20Version%206.43.121.0.pdf)
