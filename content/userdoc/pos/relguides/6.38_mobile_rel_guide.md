---
title: "Version 6.38"
date: 2021-11-29T11:46:50+02:00
draft: false
weight: 93
---
## Feature Descriptions

### Sales Receipt: Card on file

`Build 6.38.149: PRO-7628`

To simplify recurring payments, we've added the capability to save a customer's card on file via POS PRO. 
{{% notice note %}}
As of version 6.38.149, the card on file feature is available only for payments with Adyen.  
Please be advised that Teamwork doesn't store sensitive credit and debit card details. When data is transferred between Teamwork and Adyen, tokenization is used to ensure PCI compliance.  
To learn more about Adyen tokenization for recurring payments, see [Recurring payments](https://docs.adyen.com/point-of-sale/shopper-recognition/recurring-payments#card-and-shopper-identifiers) on Adyen developer portal.
{{% /notice %}}

#### Purpose

This feature may be useful for loyal customers who frequently shop in the retailer's stores. On the customer's request, the store associate can simply tap a saved card at the time of payment instead of entering card details on the payment terminal. 

Using cards on file allows for speeding up the checkout process, improving customer experience as well as building customer loyalty.

#### Configuration in CHQ

To allow saving and using cards on file in POS PRO, in CHQ under `settings > sales > payment processing >` the `Adyen terminal API` section, the **enable card on file options** checkbox must be selected.

Additionally, to allow for adding a card on file from the **Sales Receipt** area of POS, under `chq > settings > company settings > v6 App Designer > Point of Sale v6 > iPad > Sales Receipt > Receipt Options`, make sure that **Add Card on File** is placed under the **layout** section.

Furthermore, to allow for adding a card on file from a customer's record, under `chq > settings > company settings > v6 App Designer > Point of Sale v6 > iPad > Customer > Customer Form`, make sure that **Card on File** is placed under **layout**.

#### Adding a card on file from the Sales Receipt area

It's possible to save a customer's card on file even if the customer is not making a purchase with that card. 

To do so, in POS PRO:

1. On the **Home Screen**, tap **New Sale**.

2. In the **Sales Receipt** area, on the **Customer** tab, add a customer record. This is required for saving a card.

2. Tap **Add Card on File**. Depending on your custom settings, the button may be located at the top of the right-side panel {{% inum "1" %}} or in the **More** menu {{% inum "2" %}}:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_1.jpg" width="700px"%}}
{{% notice note %}}
The user must be granted the **Sales – Save to CC on file** security right to save the customer's card.
{{% /notice %}}
3. When the `Waiting for terminal...` screen appears, have the customer swipe, insert, or touch their card on the connected payment terminal:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_2.jpg" width="700px"%}}
{{% notice note %}}
Interacting with the payment terminal is needed for authorization only. The customer's card is not charged.
{{% /notice %}}
After the authorization has been completed, the `Approved` icon appears. Also, at the bottom, you'll see the following message: `The card has been added to the customer's record`.

4. Tap **Close** to return to the **Sales Receipt** area. Please note that it's not required to finalize the Sales Receipt.

##### Card processing errors

If card authorization went through but the card wasn't saved on the customer's record – for example, if there's no Internet connection – the user may get the `Server Unavailable` message. It may be required to check your Internet connection and then try again.

Alternatively, if card authorization has failed, the user may get the following errors:

- `Payment Declined`: the request for card processing has been declined by the payment processor
- `Payment Not Processed`: the request for card processing hasn't been completed

In the case of `Payment Declined` and `Payment Not Processed` statuses, POS PRO shows an error code and a message that indicate the cause of the issue.

#### Cards on file in the customer's record

The customer's saved cards can be reviewed under `Customers > [your customer record]` under the **CARD ON FILE** section:

{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_3.jpg" width="700px"%}}

For each card, the following information is available:

- **TYPE**: type of the card, for example, Visa or Mastercard
- **LAST 4**: last fout digits of the card's number
- **EXPIRATION**: card expiration date
- **ADDED**: date when the card was saved on the customer's record

To remove a card from the customer's record, tap **REMOVE** next to the required card. Please note that to do that, the **Sales – Remove card on file** security right is required.

To save a new card, tap **ADD** at the top-right of the **CARD ON FILE** section and then:

1. When the `Waiting for terminal...` screen appears, have the customer swipe, insert, or touch their card on the connected payment terminal:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_2.jpg" width="700px"%}}
After the authorization has been completed, the `Approved` icon appears. Also, at the bottom, you'll see the following message: `The card has been added to the customer's record`.

4. Tap **Close** to return to the customer's record.

#### Using a card on file for payment

To take a payment with the customer's card on file, in POS PRO:

1. On the **Home Screen**, tap **New Sale**.

2. In the **Sales Receipt** area, add sale items.

3. On the **Customer** tab, add a customer record. This is required for using a card on file. 

4. Tap **PAYMENT** at the bottom-right.  
In the **Payment** area, if the customer has cards on file, the **file folder** icon will display over your **[Adyen Credit Card payment method]**:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_4.jpg" width="700px"%}}

5. Tap the **[Adyen Credit Card payment method]**.

6. In the area that opens, on the right, tap to select the required card on file:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_5.jpg" width="700px"%}}
{{% notice note %}}
To select a card on file, the user must be granted the **Sales – Use card on file pmnt method** security right. Otherwise, manager override is required.
{{% /notice %}}
{{% notice info %}}
If the customer is paying with a card that is not saved, it's possible to turn on the **Add card to file** switch at the bottom-right. This allows for saving the card on the customer's record once the payment is processed.
{{% /notice %}}

7. Tap **PROCESS PAYMENT**.  
The `Waiting for terminal...` screen appears while the payment request is in progress. Once the payment is processed, the `Approved` icon appears.

9. Tap **Close** to return to the **Home Screen**. 

#### See also

- [V6.38 CHQ Release Guide](https://twdocs.netlify.app/userdoc/chq/relguides/6.38_chq_relguide/)
- [Mobile Quick Reference Guides](https://twdocs.netlify.app/userdoc/pos/qrg/)

### New Adjustment payment method

`Build 6.38.149: PRO-4664, PRO-825`

We've introduced a new payment method – Adjustment. 

#### Purpose

The Adjustment payment method can be used to adjust the receipt total to the required negative or positive amount when issuing or redeeming a Credit Memo. 

For example, due to customer service faults, the store manager wants to appease the customer by issuing a $50 Credit Memo. To do so without performing a refund, users can now do the following:

1. Start a new receipt and then, via the Adjustment payment method, set the receipt total to `Change Due: - $50`.
2. Select the Credit Memo payment method and enter the `$50` amount. Note that, as the receipt total is set to negative, the Credit Memo payment method is used as a means to *give* value to the customer.  
On saving, a $50 Credit Memo is created and linked to the customer's account. Additionally, the receipt total is now balanced, and the transaction can be finalized.

Thus, the Adjustment method allows for offering compensation to customers without making a refund as well as recording the newly created value for accounting purposes. 

#### Configuration in CHQ

To be available in POS, the Adjustment payment method must be set up in CHQ under `settings > sales > payment methods`. When configuring, make sure that **payment type** is set to `adjustment`.  
Note that the **code** field defines how the payment method is called in POS PRO. 

Furthermore, to ensure that the payment method is available for a specific location:

1. Under `settings > sales > payment methods`, click **[your Adjustment payment method]** and then click **location settings** at the top.
2. Double click your location in the list.
3. In the dialog that opens, select the **visible** checkbox.
4. Save the changes. 

Lastly, make sure that there's at least one adjustment payment reason available under `settings > sales > adjustment payment reasons`.

#### Using the Adjustment payment method to issue a Credit Memo

1. On the Home Screen, tap **New Sale**.

2. In the **Sales Receipt** area that opens, on the **Customer** tab, add the required customer. To do so, use the **Customer Search** field or tap **Scan with Camera** to scan the customer's member code. 

3. Tap **PAY** at the bottom-right.

4. In **Payments**, on the right, tap **[your Adjustment payment method]**.
{{% notice note %}}
To select an Adjustment payment method, the user must be granted the **Payments – Allow adjustment payment** security right.
{{% /notice %}}
5. In the dialog that opens, configure the following fields:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_17.jpg" width="700px"%}}
    - **Type**: adjustment type. To issue a Credit Memo, `Give Credit` must be selected
    - **Reason**: reason for making an adjustment
    - **Amount**: the amount to be adjusted. For example, if a $50 Credit Memo is to be issued, set to `$50`

6. Tap **Done** in the upper right corner. 

7. Back in the **Payments** area, on the right, tap **[your Credit Memo payment method]**.
{{% notice note %}}
To issue a Credit Memo, the user must be granted the **Sales – Issue credit memo** security right.
{{% /notice %}}
8. In the area that opens, under **Change Due**, enter the required credit amount and then tap **GIVE CHANGE** at the bottom:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_18.jpg" width="700px"%}}
9. Back in **Payments**, tap **FINALIZE** at the bottom-right. 

On finalizing, the issued Credit Memo is linked to the customer's profile. Additionaly, the Credit Memo number will be available on the printed Sales Receipt.

#### Adjustment payments in Drawer Memo

Adjustment payments can be reviewed during the End of Day process under `Drawer Memo > End of Day > PAYMENTS > [your Adjustment payment method]`:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_19.jpg" width="700px"%}}
In the area, the following two tabs are available:

- **Summary**
- **Transactions**

The **Summary** tab provides the following totals:

- **Payments**: the total of all positive adjustments
- **Credits**: the total of all negative adjustments
- **Net Total**: the difference between **Payments** and **Credits**

Furthermore, the **Transactions** tab shows the details of all recorded Adjustment transactions. 

#### See also

- [V6.38 CHQ Release Guide](https://twdocs.netlify.app/userdoc/chq/relguides/6.38_chq_relguide/)
- [Mobile Quick Reference Guides](https://twdocs.netlify.app/userdoc/pos/qrg/)

### Managing Reserve Orders

`Build 6.38.149: PRO-6831`

In version 6.38.149, we've added the capability to manage Reserve Orders in POS PRO. 

#### Purpose

Reserve Orders allow store associates to reserve items in-store in the following scenarios:

- an item is out for cleaning or repair
- a customer has called the store and asked to put an item on reserve

To ensure that the reserved item is not oversold, the reserved quantity is removed from available-to-sell until the Order is released. Also, by configuring the **Expiration Date** setting, users can set the date and time when the Order expires and items are returned to available-to-sell automatically. 

In cases when merchandise is reserved by a customer, users can put the Reserve Order on hold until the customer comes to the store. Also, to easily find the Order by customer information, users can add a customer record.

If the customer reviewed the merchandise and decided to make a purchase, the Reserve Order can be released manually and a new Sales Receipt created.

##### Reserve Orders vs. Held Sales Receipts

Although reserving and holding merchandise are similar functionalities, it's recommended they are used in different situations. 

Put the Sales Receipt on hold when you've started processing a purchase but there's a delay – for example, the customer has decided to shop some more. Be advised that, depending on your location settings, all held Receipts may be automatically cleared at a certain time of day or within a time period after holding (`chq > settings > location settings > locations / location settings > sales >` the `clear all held receipts at` and `clear all held receipts after (mins)` fields).

Furthermore, use Reserve Orders when merchandise must be taken out of stock for maintenance or is specifically reserved by a customer. Reserve Orders allow for holding merchandise for longer. Additionally, it's possible to set the date and time when the Order expires, and all the items are returned to available-to-sell. 

#### Configuration in CHQ

To make the **Reserve Orders** option available from the Home Screen of POS PRO, in CHQ, it's required to:

1. Go to `settings > company settings > v6 App Designer`.
2. Under `Point of Sale v6 > iPad > Home`, place the **Reserve Orders** label under **layout**.  
Note that the first four labels in the list display in the navigation panel proper, and the rest appear in the **More** menu. 

Also, under `settings > company settings > v6 App Designer > Point of Sale v6 > iPad > Reserve Orders`, it's possible to configure the layout of the Reserve Orders related areas. 

Additionally, to be able to create Reserve Orders in POS, make sure that at least one reserve reason is available under `chq > settings > inventory / catalog > reserve reasons`.

#### Viewing the list of existing Reserve Orders

Existing Reserve Orders are available in the new **Reserve Orders** area. Additionally, in the area, it's possible to:

- search for a specific Order
- open an existing Order for editing
- start a new Order

To open the **Reserve Orders** area, on the **Home Screen** of POS PRO, tap **Reserve Orders**. Depending on your custom settings, the button can be located:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_10.jpg" width="600px"%}}
- in the navigation bar at the bottom {{% inum "A" %}}, or
- in the **More** menu {{% inum "B" %}}

In the area that opens, the following information is available on existing Reserve Orders:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_11.jpg" width="700px"%}}
- **Universal #**: universal document number
- **Order #**: Reserve Order number
- **Created**: date and time when the Order was created
- **Reserve Reason**: reason for reserving items
- **Customer**: customer who reserved the items
- **Status**: Reserve Order status. The following statuses are possible:
    - `On Hold` if the Order has been put on hold
    - `Editing` if the Order is being edited on another device or in CHQ
    - the column is empty if the Order has been released, meaning that the items are no longer reserved
- **Order Qty**: the total quantity of all items on the Order

To sort the list of Reserve Orders by a specific column, tap that column's name once to change the order from descending to ascending.

Also, to view or edit the details of a Reserve Order, tap that Order in the list.

Additionally, to search for a specific Order:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_12.jpg" width="700px"%}}
- tap **Scan** {{% inum "A" %}} and then scan the printed Order, or
- use the **Search** field for manual entry {{% inum "B" %}}

Scanning and searching is possible by the Order's **Universal #**, **Order #**, or the customer's name, primary email, or primary phone number.

To create a new Reserve Order, tap **New Order** in the upper right corner.

#### Creating a new Reserve Order

To create a new Reserve Order:

1. In the **Reserve Orders** area, tap **New Order** in the upper right corner:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_13.jpg" width="700px"%}}
2. In the area that opens, on the **Order** tab, define the **Reserve Reason** field:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_20.jpg" width="700px"%}} 
Optionally, in the **Expiration Date** field, set the date when the items on the order should be automatically returned to available to sell.  
The other fields on the **Order** tab are read-only and include the following:

    - **Order #**: order number
    - **Universal**: universal order number
    - **Status**: order status. Possible values are `Held` and `Released`
    - **Last Edited**: date and time of the last edit as well as the user who edited
    - **Released**: date and time when the order was released as well as the user who released
    - **Created**: date and time when the order was created as well as the user who created
    - **Notes**: notes added by users
    - **Order Quantity**: total item quantity on the order
    - **Reserve Quantity**: total item quantity with the `Reserved` status
3. Tap the **Customer** tab at the top.
4. On the **Customer** tab, add a customer record by doing one of the following:

    - tap **Scan with Camera** to scan the customer's membership code
    - use the **Customer Search** field to find the required customer. By tapping **All** next to the search field, you can choose by which customer field to search
    - tap **New Customer** to create and add a new customer record

5. Tap the **Items** tab.
6. To add an item to the Order, do one of the following:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_21.jpg" width="700px"%}} 
    - tap **Scan** at the top and then scan the required item {{% inum "A" %}}
    - scan the item with your RFID reader
    - use the **Search** field to find the item {{% inum "B" %}}

Note that each item is added with **Order Qty** = `1` and assigned the `Reserved` status.

7. To change the item's quantity:

    - Swipe the required item left and then tap **Edit**.
    - In the dialog, define the **Order Quantity** field. 
    - Tap **Save** in the upper right corner.

{{% notice tip %}} 
To automatically open the **Edit** dialog when an item is added, turn on the **Edit Quantity** switch at the top.
{{% /notice %}}

8. To remove an item from reserve or completely from the order, swipe the item left and then tap **UnReserve** {{% inum "A" %}} or **Remove** {{% inum "B" %}} respectively:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_22.jpg" width="700px"%}} 

9. To automatically open the printing options dialog when releasing the Order, turn on the **Print on Release** switch at the bottom.

10. To save and put the Order on hold, tap **Hold** at the top-right {{% inum "A" %}}. The items will remain reserved until the Order is released manually or expired:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_24.jpg" width="700px"%}} 
Alternatively, to remove the Order from reserve, tap **Release** {{% inum "B" %}}. All items on the Order will be returned to available to sell. 
{{% notice note %}}
The **Archive** option is enabled after the Order has been saved by tapping **Hold** or **Release**.
{{% /notice %}}

#### See also

- [V6.38 CHQ Release Guide](https://twdocs.netlify.app/userdoc/chq/relguides/6.38_chq_relguide/)
- [Mobile Quick Reference Guides](https://twdocs.netlify.app/userdoc/pos/qrg/)

### Integration with Avalara

`Build 6.38.149: PRO-7675`

With this update, we've integrated POS PRO V6 with Avalara, a tax compliance platform. 

#### Purpose

Integration with Avalara allows users to quickly retrieve up-to-date tax rates when processing a purchase. 
{{% notice info %}}
Please note that for items that are shipped to the customer, taxes are calculated based on the shipment's destination address. 
{{% /notice %}}
With information from Avalara retrieved, POS PRO automatically updates the Sales Receipt total to include tax rates.

#### Configuration in CHQ

For Avalara integration to be available in POS PRO, configure the former in CHQ under `settings > sales > sales documents >` the `tax calculation service` section. In particular, in the **tax calculation service** field, select `avalara` and then fill out the **tax service URL**, **account member**, and **license key** fields. 

Additionally, to enable Avalara integration for a specific location, under `settings > location settings > locations / location settings > [selected location] > sales` > the `taxes` section, configure the following:

- select the **use service for tax calculation** checkbox
- in the **service tax area** field, select `avalara`
- in the **use tax calculation service for**, define which types of items are eligible for tax calculation

Furthermore, each item must have a tax category assigned under `inventory > styles & items > [selected style/item] > general` in the **tax category** field. Tax categories can be set up under `settings > company settings > taxes > tax categories`.

#### Tax calculation in the Sales Receipt area

In the **Sales Receipt** area of POS PRO, taxes are automatically calculated when the user proceeds to payments by tapping **PAY**. When calculating taxes, the **Retrieving tax information...** notification may appear:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_7.jpg" width="300px"%}}
In **Payments**, the calculated tax amount will be included in the **Payment Due** value. 

Alternatively, to manually retrieve taxes before proceeding to **Payments**, tap the **calculator** icon in the right-side panel. If sales tax is applied, the icon is available in the **Sales Tax** field {{% inum "1" %}}:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_6.jpg" width="700px"%}}
Alternatively, if VAT is applied, the icon is available in the **VAT Included** field:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_39.jpg" width="700px"%}}  
Tapping the icon allows for updating the **Sales Tax** or **VAT Included** as well as the **TOTAL** value in the receipt. 

After all taxes have been retrieved, the **calculator** icon is grayed out meaning that there are no taxes to calculate.   

However, the taxes are re-calculated and the icon changes to blue if one of the following occurs:

- an item is added to or removed from the sale
- an item's price is changed in any way, for example, by discount application
- a global (transaction-level) discount is applied or removed
- an item is marked as a ship item, or that status is removed
- a customer is added, changed, or removed
- an item fee is added, changed, or removed
- a global (transaction-level) fee is added, changed, or removed

For ship items, taxes are re-calculated if:

- delivery method has changed
- the fill location of the shipment has changed

##### Avalara taxes in the [item name - edit] dialog

Item-specific tax information is available in the **[item name - edit]** dialog.

To open the dialog, under `Sales Receipt > Cart`, tap the required item and then tap the **Taxes** tab on the left:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_8.jpg" width="700px"%}}
On the tab, the following fields are available:

- **Tax Exempt**: item tax exemption status
- **Tax Area**: tax area retrieved from Avalara
- **Tax %**: total tax percentage retrieved from Avalara
- **Total Item Tax**: total tax amount not including fee taxes

#### See also

- [V6.38 CHQ Release Guide](https://twdocs.netlify.app/userdoc/chq/relguides/6.38_chq_relguide/)
- [Mobile Quick Reference Guides](https://twdocs.netlify.app/userdoc/pos/qrg/)

### Updated Sales Receipt printing

`Build 6.38.149: PRO-8727`

To enhance user experience, we've introduced updates to several printing related areas of POS PRO. 

Additionally, as a part of this update, we've added the capability to configure if the customer's card info should be printed on the receipt or invoice.

#### Updates in the Sales Receipt area

In the **Sales Receipt** area, printing options for different documents are now available on separate tabs:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_26.jpg" width="700px"%}}
On the **Sales Receipt** tab, the following options are available:

- **Print**: prints the Sales Receipt
- **Store Copy**: prints a store copy of the Sales Receipt
- **Email**: sends the Sales Receipt to the customer's email

Furthermore, on the **Gift** tab, it's possible to tap **Select Items** to configure the number of Gift Receipts to be printed. 

If at least one option is selected on a tab, the green **check** icon displays on that tab label:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_27.jpg" width="450px"%}}
That allows for keeping track of what documents will be printed without having to go through each tab. 

##### Updates for countries with fiscalization settings

If the initialized location has fiscalization settings enabled and belongs to the country that uses invoices, additional **Invoice** tab is available {{% inum "A" %}}:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_28.jpg" width="700px"%}}
On the tab, the following options are available:

- **Print**: prints the Invoice
- **Store Copy**: prints a store copy of the Invoice
- **Email**: sends the Invoice to the customer's email. For countries where emailing fiscal receipts is not permitted, the **Email** option is not visible

On tapping any of the options listed above, the **Invoice Information** dialog appears where it's possible to fill out customer information to be printed.

Note that, for all countries with fiscalization settings except France, printing both the Sales Receipt and Invoice is not allowed. Respectively, if the user taps any options on the **Invoice** tab, all selections on the **Sales Receipt** tab are cleared, and vice versa. 

Additionally, if no printing options are selected, the Sales Receipt is printed by default.

##### Printing updates for France

For locations in France that have fiscalization settings enabled, we've added the capability to print both a Sales Receipt and an Invoice against one sale. 

In the **Sales Receipt** area, if at least one option is selected on both the **Sales Receipt** and **Invoice** tabs, both documents are printed.

#### Updates to the Print Options dialog

{{% notice info %}}
The **Print Options** dialog allows for selecting the printer, document template, and the number of copies to print. To open the dialog, in the **Sales Receipt** area, tap **Print Options** at the top-right.  
Be advised that, if the **Select Printer** field is not defined, the user is not able to select the respective document type for printing.
{{% /notice %}}
In the **Print Options** dialog, we've changed how a document type is selected. To select which document to configure, tap the document label at the top {{% inum "A" %}} and then select the required option:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_29.jpg" width="700px"%}}
Also, as a part of this update:

- the **Type** field has been removed from the dialog 
- the **Print Preview** switch has been added. If turned on, a preview of the respective document appears before printing. Note that the **Print Preview** switch is not visible at locations with enabled fiscalization settings

#### Updates in the Sale Complete area

In the **Sale Complete** area that appears after a sale is finalized, we've added the following options:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_25.jpg" width="700px"%}}
- **Reopen Cash Drawer**: opens the cash drawer. The option is not visible if there's no connected cash drawer
- **Reprint/Email**: prints and/or emails the same documents that were configured before the user tapped **FINALIZE**. For example, if the user emailed a Sales Receipt and printed a Gift Receipt before finalization, another email is sent and a copy of the Gift Receipt is printed 
- **Sales History**: takes the user to the **Payments** area of the finalized Receipt. From **Payments**, it's possible to print and email the receipt with new printing configurations

#### Printing credit card info on receipts

Under `Sales Receipt > Payments`, we've added a new **Print credit card info** switch:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_30.jpg" width="700px"%}}
If turned on, the customer's card info – in particular, card type, last 4 digits, and expiration date – is printed on the Sales Receipt or Invoice proper. Please note that this setting is not applicable to Store Copies and Gift Receipts.
{{% notice info %}}
The state of the **Print credit card info** in POS PRO is determined by the following settings located under `chq > settings > sales > sales documents`:

- **print customer credit card info on receipts option**
- **print customer credit card info on invoices option**

If `always` or `never` is selected, the **Print credit card info** switch is not visible in POS PRO. Alternatively, if `default true` or `default faulse` is selected, the switch is visible and available for configuration in POS PRO.
{{% /notice %}}
Additionally, the switch does not display if:

- there's no credit card payment or a credit card refund made against the receipt
- the **Print** option is not selected for the document

#### See also

- [V6.38 CHQ Release Guide](https://twdocs.netlify.app/userdoc/chq/relguides/6.38_chq_relguide/)
- [Mobile Quick Reference Guides](https://twdocs.netlify.app/userdoc/pos/qrg/)

### Ship Memos: Multiple carton support

`Build 6.38.149: PRO-8592`

We’ve added the capability to assign multiple cartons on a single Ship Memo.

#### Purpose

This new functionality can be helpful if, for example, the retailer sells several large items and wants to send those in a single shipment but in separate packages.

Adding the above capability required updating the following tabs under `Shipments > Outgoing > Ship Memo` of POS PRO version 6:

#### Items

We’ve added a new column – **Carton**:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_33.jpg" width="700px"%}}
The column displays the number of the carton that’s assigned to the respective item.

If there are multiple ship quantities that are assigned to several cartons, then carton numbers are separated by a comma. If no carton is assigned, the respective field remains blank.

Please be advised that once a Ship Memo is booked for any carton, it is no longer possible to change **Ship Qty** or **Rej Qty** values.

Also, if the user wants to change quantities for an item after any carton has a ship label, they must void the label(s) first.

#### Cartons

This is a new tab where you can add cartons and assign those to items:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_34.jpg" width="700px"%}}
To search for an item on the tab’s item grid, use the **Search** field ({{% inum "1" %}} in the screenshot above). You can search by UPC, PLU, CLU, Style No, four description fields and three attribute fields. Please be advised that you CANNOT add items to Ship Memo via this search.

To assign the selected carton to all the unassigned items, tap **Pack All** {{% inum "2" %}}.

To select among existing cartons or add a new one, tap **Carton [number]** {{% inum "3" %}}. 

**Carton [number]** indicates which exactly carton is currently selected for assigning to items on tapping **Pack** or **Pack All**. For example, if `Carton 1` displays, on tapping **Pack** in the item grid the respective item will have Carton 1 assigned to that. 
{{% notice tip %}}
For a fast workflow, if there is a shipment that needs only one carton, **Carton 1** is specified by default and the user needs to tap **Pack All** to assign all the unassigned items to one carton.

Alternatively, the user might want to create multiple cartons before they start assigning cartons to items. For example, if the user knows they will use 4 cartons, they can tap **Carton [number]** and then tap **Add Carton** 3 times.   
Also, if a carton remains unassigned to any items, that carton is not saved on the document. 
{{% /notice %}}

##### Item grid

In the item grid, it is possible to review item related information, including, for example, item description, size, and color:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_35.jpg" width="700px"%}}
The **Ship Qty** column displays the ship quantity for the item from the **Items** tab. Please note that if the ship quantity for an item is greater than 1, then multiple rows display on the **Cartons** tab. For example, if an item’s ship quantity equals `3`, there are 3 separate rows with **Ship Qty** `1` shown on the tab.

The **Carton** column allows for assigning the carton to a line item. By default, the **Pack** label displays in the column. This indicates that no carton has been assigned to the respective line item yet. Tapping **Pack** assigns exactly the carton that is defined on the right above the grid. For example, in the screenshot above, this is `Carton 1` that will be assigned to any line item by tapping **Pack**.

Once a carton is assigned, instead of **Pack**, the respective **Carton [number]** label displays. Tapping **Carton [number]** next to a line item allows for changing or unassigning the carton (**Clear Carton #**). In the latter case, the **Pack** label displays again.

#### Shipment

On the **Shipment** tab, the information related to the shipment displays in the following sections:

- SHIPMENT
- SHIP TO ADDRESS
- SELECT CARTON

{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_36.jpg" width="700px"%}}
Under **SHIPMENT**, it is possible to review the shipping method copied from the original sales order in the **Requested Ship Method** field. Also, in the **Status** field the current **Ship Memo** status displays.

Under **SHIP TO ADDRESS** the editable **Ship To** address displays. Please be advised that once a carton is booked (tracking number obtained), the address cannot be edited. If the user books a shipment and then voids it, and none of the cartons is booked, the address becomes editable again.

Under **SELECT CARTON**, the list of assigned cartons is available one carton per row.

The **Carton [number]** label is tappable and brings up the **Shipment - Carton [number]** dialog with all the shipment-related functions (see below for details).

If the carton hasn’t been shipped yet, the `Not Shipped` text displays in red on the right. If the carton has been shipped, the following information is available in the respective row (left to right): carton number, delivery method, ship method, tracking number.

If there are any items that do not have a carton assigned, at the section bottom the `Assign all items to a carton before completing shipments` text displays.

#### Shipment - Carton [number] dialog

In the dialog, the available shipment-related functions are distributed among the following sections:

- SHIPMENT
- SHIPPING INFO
- SHIPMENT DETAILS

{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_37.jpg" width="500px"%}}
Under **SHIPMENT**, it is possible to specify the delivery method, weight and dimensions as well as get and print the box label.

Under **SHIPPING INFO**, it is possible to review the **Ship From** address as well as review and edit the **Ship To** address.

Under **SHIPMENT DETAILS**, it is possible to review ship method, tracking number, return tracking number, and status.

If the dialog is opened after the shipment is booked, all the dialog fields are read-only:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_38.jpg" width="500px"%}}
{{% notice info %}}
If shipped via ShippyPro:

- tapping **Print** in the upper-right corner of the dialog allows for printing the label and return label (if exists)
- tapping **Void Label** next to **Tracking Number** allows for voiding the label/shipment

If the user changes to a manual shipment after the label has been retrieved, they must void the label and re-enter the shipment for the carton.  
Once the ship memo is finalized, the **Void Label** option is no longer available, but the user can still print the labels.
{{% /notice %}}

#### See also

- [V6.38 CHQ Release Guide](https://twdocs.netlify.app/userdoc/chq/relguides/6.38_chq_relguide/)
- [Mobile Quick Reference Guides](https://twdocs.netlify.app/userdoc/pos/qrg/)

### Storing held Sales Receipts in the cloud

`Build 6.38.149: PRO-5220`

Prior to version 6.38.149, held Sales Receipts were stored only in the local database. Respectively, it wasn't possible to hold a Receipt on one device and then finalize on another device. 

Now, held Sales Receipts are stored at the server side which allows users to edit such Receipts from any initialized device. This update resulted in several changes in POS PRO UI. 

#### Purpose

Putting a Sales Receipt on hold allows for saving the Receipt in its current state without finalizing. That may be useful if, for example, a customer at the checkout decided to shop some more before making a payment, or if the sale must be put on hold for any other reason. 

If, for example, the receipt was put on hold at checkout A but then the customer approached checkout B to make a payment, it's now possible to retrieve the receipt from the cloud and finalize at checkout B.

##### Held Sales Receipts vs. Reserve Orders 

Although reserving and holding merchandise are similar functionalities, it's recommended they are used in different situations. 

Put the Sales Receipt on hold when you've started processing a purchase but there's a delay – for example, the customer has decided to shop some more. Be advised that, depending on your location settings, all held Receipts may be automatically cleared at a certain time of day or within a time period after holding (`chq > settings > location settings > locations / location settings > sales >` the `clear all held receipts at` and `clear all held receipts after (mins)` fields).

Furthermore, use Reserve Orders when merchandise must be taken out of stock for maintenance or is specifically reserved by a customer. Reserve Orders allow for holding merchandise for longer. Additionally, it's possible to set the date and time when the Order expires, and all the items are returned to available-to-sell. 

#### Held Sales Receipts in POS PRO

In POS PRO, held receipts are available under `Sales Receipts > On Hold`:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_9.jpg" width="700px"%}}
{{% notice info %}}
The **red dot** icon next to the **On Hold** tab label indicates that there are held receipts available.
{{% /notice %}}
To filter the list of receipts, tap **Filter** at the top-left ({{% inum "1" %}} in the screenshot above).

To edit or discard a receipt, swipe left the required document and then tap **Unhold** or **Discard**, respectively {{% inum "2" %}}.  
Alternatively, to discard all the receipts available on the tab, tap **Discard All** at the top-right and then **Yes** in the confirmation dialog.

To set default printing options for held receipts, tap **Options** at the top-right {{% inum "3" %}} and then **Printing Options**. In the dialog that opens, select **More** > **Held Receipt**.
{{% notice note %}}
It's not possible to manually print a held receipt from the **On Hold** tab.  
To automatically print a receipt when the latter is put on hold, in CHQ under `settings > location settings > locations / location settings > [selected location] > sales`, select the **prompt to print on hold** and then click **save**.
{{% /notice %}}

#### See also

- [V6.38 CHQ Release Guide](https://twdocs.netlify.app/userdoc/chq/relguides/6.38_chq_relguide/)
- [Mobile Quick Reference Guides](https://twdocs.netlify.app/userdoc/pos/qrg/)

### Updates to removing a Sales Receipt from hold

`Build 6.38.149: DS-3000`

Prior to version 6.38.149, to remove a Sales Receipt from hold under `Sales Receipts > On Hold`, users had to swipe the document left and then tap **Unhold**. 

Now, simply tapping the document removes the latter from hold and opens for editing. 

Also, once the document is open, tapping **Close** in the upper left corner now discards the document from the device. After tapping, the user will see the **Discard Receipt** dialog where it's required to tap **Yes** to confirm.

Alternatively, to put the receipt back on hold, it's possible to tap **Hold** in the upper right corner.

### Adyen payment requests extended with app and device information

`Build 6.38.149: PRO-8093`

We've extended payment requests sent to the Adyen payment processor with information about the POS PRO app and device that generated the request.

In particular, the following information is now included:

- application name 
- application version
- operating system that runs on the device
- operating system version
- device name

Passing app information allows Adyen to analyze and troubleshoot payments more efficiently as well as provide a better support experience. 

### Region-based date format on Home Screen

`Build 6.38.149: PRO-8564`

Starting from version 6.38.149, the date format on POS Home Screen is based on the region defined in the device settings.
{{% notice info %}}
To set a region for your device, on your iPad, go to `Settings > General > Language & Region` and then define the **Region** field.
{{% /notice %}}
For example, if region is set to `France`, the date will display as `dddd dd MMMM`:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_14.jpg" width="700px"%}}

### Ship Memo: Separate security rights for shipping and rejecting all items

`Build 6.38.149: PRO-8396`

With this update, we've added the following new security rights:

- **V6 Ship Memos – Ship All**: users with this right will have the **Ship All** button enabled under `Shipments > Outgoing > [selected Ship Memo] > Items`
- **V6 Ship Memos – Reject All**: users with this right will have the **Reject All** button enabled under `Shipments > Outgoing > [selected Ship Memo] > Items`

Also, previously existing **V6 Ship Memos – Ship/Reject All** security right has been removed.

### New security rights for removing sale items and discarding Sales Receipts

`Build 6.38.149: PRO-8536`

POS PRO now respects the following new security rights:

- **Sales Receipts – Allow removing item from cart**: users without this right cannot remove sale items under `Sales Receipt > Cart`. When trying to remove, the **Insufficient Rights** dialog appears with an option to perform manager override
- **Sales Receipts – Allow discarding a sales receipt**: users without this right cannot discard a new Sales Receipt. When trying to discard, the **Insufficient Rights** dialog appears with an option to perform manager override

{{% notice note %}}
If no changes have been applied to the newly created Sales Receipt, it can be dicarded without the **Sales Receipts – Allow discarding a sales receipt** security right.
{{% /notice %}}

#### See also

- [V6.38 CHQ Release Guide](https://twdocs.netlify.app/userdoc/chq/relguides/6.38_chq_relguide/)
- [Mobile Quick Reference Guides](https://twdocs.netlify.app/userdoc/pos/qrg/)

### Showing a progress message when opening the cash drawer

`Build 6.38.149: PRO-7137`

When opening the cash drawer from various areas of POS PRO, users will now see the `Opening cash drawer...` message if the process takes some time. 

This update relates to the **Open Cash Drawer** option in the following areas:

- `Settings > Printers > Add New Printer` and `Edit Printer`
- `Sales Receipts > Options > Open Cash Drawer`
- `Drawer Memo`
- `Drawer Memo > Manage Cash > Take Out`, `Take In`, and `Deposit`
- `Sales Receipt > Sale Complete`
- `Drawer Memo > Start of Day > Opening Count` for base and foreign currencies
- `Drawer Memo > End of Day > Closing Count` for base and foreign currencies

### Viewing finalized Sales Receipts without an active Drawer Memo

`Build 6.38.149: PRO-6649`

We've added the capability to view finalized Sales Receipts without an active Drawer Memo.

Prior to version 6.38.149, users were unable to do so because finalized Receipts automatically open in the **Return** area, and returns cannot be performed without an active Drawer Memo.

To view a finalized Sales Receipt:

1. On the Home Screen of POS PRO, tap **Sales Receipts**.
2. In the **Sales Receipts** area, open the **Sales History** or **Device History** tab. 
3. Tap a Receipt in the list or use the **Find Receipt** option to open the required document. 

The **Return** area will appear where it's possible to review the details of the Sales Receipt:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_15.jpg" width="700px"%}}

Please note that, as Verified Returns cannot be performed without an active Drawer Memo, it's not possible to select any return-related options. For example, on tapping **Select Reason** for a specific item or in the **RETURN ALL** field, the **Cannot Process Return** error message appears. 

To review full information on the Sales Receipt, in the **Trans #** field on the right, tap **View**:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_16.jpg" width="700px"%}}
On tapping, the **Sales Receipt** area opens with all the details of the original Receipt. Note that, on tapping **Return** in the **Sales Receipt** area, the **Cannot Process Return** error message appears.

#### See also

[Mobile Quick Reference Guides](https://twdocs.netlify.app/userdoc/pos/qrg/)

### Drawer Memo: Updated Midday Count

`Build 6.38.149: PRO-8788`

We've updated the Midday Count functionality in POS PRO. 
{{% notice info %}}
Midday counts allow for checking drawer balance during the day and ensuring there are no discrepancies. Additionally, if no cash payments were made after a midday count, the latter can be used as the end-of-day count to speed up the store closing procedures.
{{% /notice %}}
Now, a Midday Count cannot be used as the end-of-day count if one of the following records was created after that Midday Count:

- Take In
- Take Out
- Move to Safe
- Move to Drawer
- Deposit

#### See also

[Drawer Memo: Performing midday counts of cash and masking “expected” amounts](https://twdocs.netlify.app/userdoc/pos/relguides/6.34_mobile_rel_guide/#drawer-memo-performing-midday-counts-of-cash-and-masking-expected-amounts)

### Increased max length of the Customer Profile Link field

`Build 6.38.149: PRO-8581`

We've increased the maximum length of the **Customer Profile Link** field to 2048 characters.
{{% notice info %}}
Depending on your custom settings, in POS PRO, the **Customer Profile Link** field can appear:

- in the full customer record under `Customer > [selected customer record]`
- in the customer preview under `Customer > See More`
{{% /notice %}}

#### See also

[Customer: New Customer Profile Link field](https://twdocs.netlify.app/userdoc/pos/relguides/6.34_mobile_rel_guide/#customer-new-customer-profile-link-field)

### Using customer presets for new customer records

`Build 6.38.149: PRO-8602`

POS PRO V6 now allows for making use of presets when creating new customer records. 

A customer preset defines the default state of the following customer fields:

- **Primary Email** – **Marketing**
- **Primary Email** – **Transactions**
- **Email 2** – **Marketing**
- **Email 2** – **Transactions**
- **Mobile** – **Calls**
- **Mobile** – **SMS**
- **Phone 2** – **Calls**
- **Phone 2** – **SMS**
- **Phone 3** – **Calls**
- **Phone 3** – **SMS**
- **Phone 4** – **Calls**
- **Phone 4** – **SMS**
- **Postal Address** – **Accepts Mail**
- **Loyalty Program Opt-In**

Using customer presets speeds up the process of customer registration. Additionally, this may be useful if, for example, the retailer wants to always include new customers in the company's loyalty program.

{{% notice info %}}
For POS PRO to automatically use a customer preset, in CHQ, a preset must be defined at the location or company level.  
To configure a preset for a location, under `chq > settings > location settings > locations / location settings > [your location] > general settings >` the `general` section, define the **preset customer option** field.  
Alternatively, to configure a preset at the company level, under `chq > settings > customer > customer settings >` the `general` section, define the **default customer preset option** field.
{{% /notice %}}

#### See also

- [V6.38 CHQ Release Guide](https://twdocs.netlify.app/userdoc/chq/relguides/6.38_chq_relguide/)
- [Mobile Quick Reference Guides](https://twdocs.netlify.app/userdoc/pos/qrg/)

### Availability of the Customer Profile Link field in the Sales Receipt area

`Build 6.38.149: PRO-8534`

We've added the capability to include the **Customer Profile Link** field to the following areas of POS PRO:

- `Sales Receipt > Customer`
- `Sales Receipt > Payments`

{{% notice note %}}
Please note that the **Customer Profile Link** field does not appear in the **Sales Receipt** area by default.  
To configure that, in CHQ under `settings > company settings > v6 App Designer > Point of Sale 6 > iPad > Sales Receipt`, it's required to add the field to the **Customer Tab** and/or **Customer on Payment Form** sections.
{{% /notice %}}

### Default fill location for ship items

`Build 6.38.149: PRO-8664`

We've updated how the default fill location is set for ship items in POS PRO. 

Now, the fill location is defined by the **default fill location** setting located in CHQ under `settings > location settings > locations/location settings > [selected location] > sales >` the `sales orders` section. 

If the **default fill location** setting is not defined or the configured location is inactive, the fill location defaults to the location where the respective device is initialized. 

In POS PRO, the default fill location is visible under `Sales Receipt > Cart > [item name] - edit > Ship` in the **Fill From** field. For the **Fill From** field to become available, the **Ship Type** field and the ship-to address must be defined.

### France: Printing an Invoice after the sale

`Build 6.38.149: PRO-8729, PRO-9221`

For store locations in France, we've added the capability to issue an Invoice against a finalized Sales Receipt. 
{{% notice note %}}
This update is applicable only to locations that have the following configurations:

- **country** = `France`
- the **fiscal** checkbox is selected

The settings listed above are available in CHQ under `settings > location settings > locations/location settings > [your location] > details`. **Country** is defined when the location is created and cannot be changed later.
{{% /notice %}}
This feature may be useful in situations where a customer may return to the store after the original sale and ask for an invoice.

#### Printing an Invoice from a finalized Sales Receipt

Under `Sales Receipts > Sales History > [your finalized Sales Receipt]`, to check if an Invoice has been issued at the time of the sale, pay attention to the **Print** section of the **Invoice** tab:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_31.jpg" width="700px"%}}
If the **View** button is shown, the Invoice has been issued. To re-print the Invoice, select the **Print** option and then tap **PRINT / EMAIL** at the bottom-right:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_32.jpg" width="700px"%}}
If the Invoice hasn't been issued, to create and print the latter:

1. On the **Invoice** printing tab, select **Print**.

2. In the **Invoice Information** dialog that opens, fill out customer information and then tap **Done** in the upper right corner. 

3. Tap **PRINT / EMAIL**. 

#### Updating the fiscal.Receipt table 

When an Invoice is created from the finalized Sales Receipt in POS PRO, at the database level, an additional record is created in the fiscal.Receipt table. 

The ReceiptId field for that record is populated with the sales.Invoice.InvoiceId value. 

#### See also

- [V6.38 CHQ Release Guide](https://twdocs.netlify.app/userdoc/chq/relguides/6.38_chq_relguide/)
- [Mobile Quick Reference Guides](https://twdocs.netlify.app/userdoc/pos/qrg/)


### European fiscal compliance: Removing an item from the receipt is recorded in the fiscal log

`Build 6.38.149: PRO-9367`

{{% notice note %}}
This update is applicable only to locations with the following configurations:

- **country** = `France`
- the **fiscal** checkbox is selected

The settings listed above are available in CHQ under `settings > location settings > locations / location settings > [your location] > details`. **Country** is defined when the location is created and cannot be changed later.
{{% /notice %}}
We've extended the list of events that are recorded in the fiscal log at the database level.

Now, when an item is removed from the Sales Receipt in POS PRO, a new record is created in the fiscal.EventLog table. Removing a line item is recorded under code `323`. 

Note that this event is not applicable to removing a gift card service item from the Receipt.

### Additional cases when Sales Receipt voiding/reversing is not allowed

`Build 6.38.149: PRO-8703`

We've extended the list of cases when it's impossible to void/reverse a Sales Receipt in POS PRO. 

In particular, voiding/reversing is not allowed when:

1. The user tries to void/reverse a Receipt beyond the time limit configured in CHQ. 
{{% notice info %}}
In CHQ, the time limit can be defined by configuring the following fields under `settings > location settings > locations / location settings > [your location] > payments >` the `payment processing - general` section:

- **restrict void/reverse by**
- **number of minutes**
- **time of day**
{{% /notice %}}
In this case, on tapping **Void/Reverse**, the following error message appears: `Void/Reverse Unavailable: You are beyond the payment processing void time limit`. 

2. The user tries to void/reverse a Receipt created on another device.   
In this case, on tapping **Void/Reverse**, the following error message appears: `Void/Reverse Unavailable: The sales receipt was created on another device`. 

3. The Drawer Memo associated with the Receipt is no longer active.  
In this case, on tapping **Void/Reverse**, the following error message appears: `Void/Reverse Unavailable: The drawer memo for this receipt has already been finalized`. 

### POS PRO V6 available on iPhone

`Build 6.38.149: PRO-8464, PRO-8465`

The POS PRO V6 app is now available on the following iPhone models:

- iPhone 13
- iPhone 13 mini
- iPhone 13 Pro
- iPhone 13 Pro Max
- iPhone 12
- iPhone 12 mini
- iPhone 12 Pro
- iPhone 12 Pro Max
- iPhone 11
- iPhone 11 Pro
- iPhone 11 Pro Max
- iPhone XS
- iPhone XS Max
- iPhone X

Currently, on iPhone, users can access and make use of the following POS PRO areas:

- POS App Setup
- Initialize App
- Synchronize
- User Login
- Home Screen
- Settings:
    - General Info
    - Synchronize
    - Printers
    - Payment Terminals
    - Help & Support
    - Administration

{{% notice note %}}
Please be advised that, on iPhone, certain POS PRO features – for example, creating Sales Receipts – are not available as of now.
{{% /notice %}}

### Clover Mini: Partial authorization of payment requests

`Build 6.38.174: DS-3015`

We've updated how partial authorization of a payment is handled in POS PRO when working in conjunction with a Clover Mini payment terminal. 

Partial authorization may occur when the customer is using a card that has insufficient balance to pay the full transaction amount. This, in particular, may happen with prepaid Visa or Mastercard gift cards. 

For example, if sale total is `$100`, and the customer is paying with a $36.45 gift card, the payment request is approved only for $36.45.  

In POS PRO, once the payment request is approved, the user sees the approved amount as the **Payment Amount** value at the top {{% inum "A" %}} and the requested amount below  {{% inum "B" %}}:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_44.jpg" width="700px"%}}
When the user returns to the **Payments** area, there is remaining **Payment Due**. The customer has to choose another payment method to complete the transaction. 

#### See also

- [Integration with Clover](https://twdocs.netlify.app/userdoc/pos/relguides/6.34_mobile_rel_guide/#integration-with-clover) in V6.34 POS PRO Release Guide
- [Configuring integration with Clover](https://twdocs.netlify.app/userdoc/chq/relguides/6.34_chq_relguide/#configuring-integration-with-clover) in V6.34 CHQ Release Guide

### Customer Capture Mode in POS PRO V6

`Build 6.38.174: PRO-9579`

Starting from version 6.38.174, Customer Capture Mode is available in POS PRO. 

#### Purpose

Customer Capture Mode (CCM) is intended for use on devices facing the retail customer and allows the latter to create an account in the retailer's system. 

Once customer information is submitted in CCM, a new customer record is automatically created in Teamwork. 

To prevent retail customers from gaining unauthorized access to POS, on exiting CCM, user login is required. 

Additionally, in CHQ, it is possible to configure the company logo image, privacy policy and marketing opt-in texts that display in CCM. 
{{% notice note %}}
For Customer Capture Mode to work correctly, your device must be in portrait (vertical) orientation.
{{% /notice %}}

#### Configuration in CHQ

Under `settings > company settings > company information >` the `customer capture mode` section, users can configure the following elements of the CCM view:

- company logo image
- privacy policy text
- marketing opt-in text

{{% notice info %}}
For details on how to configure the CCM view, refer to [V6.38 CHQ Release Guide](https://twdocs.netlify.app/userdoc/chq/relguides/6.38_chq_relguide/).
{{% /notice %}}

Additionally, to make the **Customer Capture Mode** option available from the Home Screen of POS PRO, under `settings > company settings > v6 App Designer > Point of Sale v6 > iPad > Home`, make sure **Customer Capture Mode** is placed under **layout**. Note that the first five labels in the list display in the navigation bar proper, and the rest appear in the **More** menu.

#### Entering an exiting CCM

To open the CCM view in POS PRO, on the Home Screen, tap **Customer Capture Mode**. Depending on your custom settings, the button can be located in the navigation bar at the bottom {{% inum "A" %}} or in the **More** menu {{% inum "B" %}}:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_40.jpg" width="700px"%}}
On tapping, CCM standby view opens:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_41.jpg" width="700px"%}}
{{% notice info %}}
To change the language of the CCM interface, tap the value in the **Language** field. The following languages are available:

- English
- French
- Japanese

Additionally, if POS interface language is set to French or Japanese, CCM opens in French or Japanese respectively. If any other language is selected, CCM defaults to English. 
{{% /notice %}}
To exit CCM, tap the company logo at the top **three times**. After exiting CCM, to use POS PRO, user login is required.

#### Creating a customer account in CCM

To create a new customer record in the retailer's environment, it's required to fill out and submit customer information.

To begin, in CCM standby view, select **Tap Here to Register**. On tapping, the customer form appears:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_42.jpg" width="700px"%}}
In the form, the following fields are available:

**Field**|**Value**|
:-----------|:-----------|
First Name|Required, 128 characters max. The value is saved to the **First Name** field of the customer record in POS PRO|
Last Name|Required, 128 characters max. The value is saved to the **Last Name** field of the customer record|
Email|Required, 128 characters max. Validation checks are performed for email address format and email adress duplicates. The value is saved to the **Primary Email** field of the customer record|
Phone Number|128 characters max. The value is saved to the **Home** field of the customer record|
Birth Day|Valid entries range from `1` to `31` depending on the **Birth Month** value. The value is saved to the **BIRTHDATE** field in the customer record|
Birth Month|The value is saved to the **BIRTHDATE** field in the customer record|
Yes/No|Defines the state of the **Marketing** opt-in switch for the **Primary Email** field in the customer record. By default, **Yes** is selected|

If there is an error in the format of the entered data, an error message appears in red under the respective field:
{{% gimg src="V6.38 Mob Rel Guide/6.38_posrelguide_43.jpg" width="700px"%}}
{{% notice info %}}
Please be advised that CCM automatically re-sets to the standby view if there is no user action within 90 seconds.
{{% /notice %}}
Once all the required fields are filled out, tap **Submit** at the bottom. On tapping, the **Creating profile...** progress message appears. 

When the customer information is saved, the **Thank You** screen appears. After three seconds, CCM changes to the standby view. 

{{% notice note %}}
If there is no Internet connection when customer information is submitted, the latter is saved in POS local database with no error messages shown in Customer Capture Mode. When Internet connection is restored, saved information is sent to CHQ.
{{% /notice %}}

#### See also

- [V6.38 CHQ Release Guide](https://twdocs.netlify.app/userdoc/chq/relguides/6.38_chq_relguide/)
- [Mobile Quick Reference Guides](https://twdocs.netlify.app/userdoc/pos/qrg/)

### European fiscal compliance: Changing INFRASEC server URL at the database level

`Build 6.38.214: PRO-10854`

Starting from version 6.38.214, the URL of INFRASEC host server can be changed at the database level by configuring the dedicated setting. This update allows POS to use the URL from the local database. 
{{% notice info %}}
INFRASEC Central Control Unit (CCU) is a cloud-based fiscal service integrated with Teamwork system. The service is used by company locations in Sweden to ensure compliance with the fiscalization requirements. 
{{% /notice %}}
{{% notice warning %}}
INFRASEC server URL cannot be configured by users via POS PRO UI. The URL is defined and updated by Teamwork at the backend. 
{{% /notice %}}

### Health check of Sweden fiscalization features

`Build 6.38.220: PRO-11248`

We've performed health check of workflows related to Sweden fiscalization features after fixing the [Verified Return fails with Invalid Tax Configuration error](https://twdocs.netlify.app/userdoc/pos/relguides/6.38_mobile_rel_guide/#verified-return-fails-with-invalid-tax-configuration-error) issue. 

### V6.38 POS PRO provisioning profile

`Build 6.38.224: PRO-12626`

We've set up the provisioning profile for POS PRO version 6.38. 

## Issue Resolutions

### Historical Sales Receipts are not purged

`Build 6.38.149: PRO-2818`

Prior to version 6.38.149, when purging Drawer Memo history was enabled for a company location, associated Sales Receipts weren't cleared together with the historical Drawer Memos.
{{% notice info %}}
To configure how ofthen Drawer Memo history is to be purged, under `chq > settings > location settings > locations / location settings > [selected location] > general settings`, define the **days of drawer memo history to save in POS** field.
{{% /notice %}}
The issue has been fixed. Now, as expected, when Drawer Memos are purged, the associated Sales Receipts are cleared as well. 

### Incorrect calculation in case of foreign currency payments

`Build 6.38.149: PRO-2818`

We've fixed the issue where, in case of foreign currency payments, POS PRO would sometimes divide an amount by the configured exchange rate instead of multiplying. 

### Extra tax record created in case of a partial Verified Return

`Build 6.38.149: PRO-2874`

Prior to version 6.38.149, when a partial Verified Return was made against a Sales Receipt (for example, one item unit was returned out of the two sold), an additional tax record could be incorrectly created at the backend. The issue occurred at company locations subject to VAT. 

The issue has been fixed. Now, when a partial return is made, the number of created tax records matches the number of returned item units. 

### Settings item quantities to less than "1"

`Build 6.38.149: DS-2983`

In POS PRO, we've added the capability to set item quantities to less than `1` – for example, `0.5` – for products that are sold by weight.

### Timeout when searching for a finalized Sales Receipt

`Build 6.38.149: DS-2941`

**Issue**

When searching for a finalized Sales Receipt by **Trans #** under `Sales Receipts > Sales History > Find Receipt`, after about 30 seconds, the **Execution Timeout Expired** error message would come up.

**Resolution**

The issue has been fixed. Now, the required Sales Receipt is found as expected.

### Availability: Incorrect Non EC ATS quantity

`Build 6.38.149: PRO-2933`

Prior to version 6.38.149, under `Catalog > [tap an item] > Availability`, the **Non EC ATS** quantity would incorrectly include items with the `not sellable` status.

Now, as expected, `not sellable` quantities are deducted from available-to-sell, and the **Non EC ATS** column shows a correct quantity.

### Ship Memo: The RMANo value is not sent to CHQ

`Build 6.38.193: DS-2861`

Prior to version 6.38.193, when a Ship Memo was finalized in the POS PRO app, POS PRO would fail to send the Return Merchandise Authorization (RMA) codes from that Ship Memo to CHQ. Respectively, in CHQ under `sales > order management > [selected Sales Order] > shipments`, the **RMA code** column would be empty for the item(s) from that Ship Memo.

The issue has been fixed. Now, when a Ship Memo is finalized, POS PRO passes the RMANo value(s), and the **RMA code** column is populated in CHQ.

### Clover: Cancelled payments appear as incomplete in POS PRO

`Build 6.38.210: DS-3032`

Prior to version 6.38.210, when working in conjunction with Clover Mini payment terminal, the **Incomplete Payments** dialog could incorrectly appear in POS PRO. The dialog would show payments that supposedly went through on the payment terminal but weren't recorded in Teamwork. 

In particular, that happened when:

1. In POS PRO, the payment was cancelled when the connected Clover device was waiting for the credit card PIN. 
2. Then, after returning to `Sales Receipt > Payments`, the user discarded the sale. 
3. The user logged out and then logged in. 

The issue has been fixed. Now, as expected, payments that were successfully cancelled before authorization do not appear as incomplete in POS PRO. 

### Banorte payment fields missing in the printed Sales Receipt

`Build 6.38.210: DS-3137`

Prior to version 6.38.210, printed Sales Receipts that included a payment with Banorte payment terminal were missing the following payment fields:

- terminalId
- amount
- rstCode
- aid

Now, all payment related fields appear on the printed Sales Receipt as expected.

### Ship Memo: Available fill locations are not restricted by fill locations table in CHQ

`Build 6.38.210: DS-2883`

**Issue**  
When processing a Ship Memo in POS PRO, the user was able to select a fill location that was configured as unavailable in CHQ.

**Resolution**  
The issue has been fixed. Now, as expected, POS PRO respects the list of available fill locations defined under `chq > settings > order management > fill locations`.

### Finalized transactions not visible in POS PRO and CHQ

`Build 6.38.210: DS-3167`

We've fixed the issue where transactions finalized in POS PRO could sometimes fail to appear in:

- `Sales Receipts > Sales History` in POS PRO
- `sales > sales receipts` in CHQ
- sales reports generated in CHQ

### Sales Receipt: The Fill From field is not populated with the default fill location

`Build 6.38.210: DS-3122`

**Issue**  
When configuring a ship item under `Sales Receipt > Cart > [item name] - edit > Ship`, the **Fill From** field wasn't populated with the default fill location configured in CHQ.

**Resolution**  
Now, as expected, the value of the **Fill From** field in POS PRO is based on the **default fill location** setting configured under `chq > settings > location settings > locations / location settings > [selected location] > sales`.

### Incorrect Adyen payment reference in return receipts

`Build 6.38.210: DS-3212`

**Issue**  
Occasionally, return receipts finalized in POS would contain an incorrect reference to the original Adyen payment: Adyen original PSP reference instead of Adyen modification (refund) reference. 

**Resolution**  
The issue has been fixed. Now, return receipts contain Adyen modification reference as expected.

### Unable to perform BORIS refund with Adyen

`Build 6.38.213: DS-3230`

Prior to version 6.38.213, it was sometimes impossible to make a Buy-Online-Return-In-Store (BORIS) refund to the customer’s credit card via Adyen. 

That happened because, to perform the refund, the system would try to use Adyen merchant account associated with the physical store instead of the merchant account associated with the original web order. As a result, the original payment PSP reference would not be found. 

To resolve this issue, the refund logic has been updated. 

Now, in case of BORIS refund, if the Sales Receipt is linked to a Sales Order, the system looks for the payment credentials from the **created at** location of that Sales Order. This way, Adyen merchant account associated with web orders is referenced, and the refund can be completed. 

### Drawer Memo health check

`Build 6.38.218: PRO-10897`

We've performed health check of Drawer Memo workflows in POS PRO to ensure that Drawer Memo functionality works as expected.

### Clover terminal stops responding

`Build 6.38.218: DS-3302`

We've fixed the issue where the connected Clover payment terminal could occassionally stop responding with the `Payment Terminal Not Responding` error message when the customer inserted their credit card.

### Finalized receipts missing item information

`Build 6.38.218: DS-3364`

Prior to version 6.38.218, some finalized receipts in POS could be missing data on the sale/return items. In particular, when the receipt was viewed under `Sales Receipts > Sales History > [selected Sales Receipt]`, a blank space would appear instead of the list of items. 

The issue has been fixed. Now, item information can be viewed in finalized receipts as expected.

### Verified Return fails with Invalid Tax Configuration error

`Build 6.38.220: DS-3440`

**Issue**  
In locations using Sweden fiscalization features, a Verified Return of an item could fail with the **Invalid Tax Configuration** error even if the item tax category was correctly configured. 

**Resolution**  
The issue has been fixed. Now, Verified Return of items with correctly configured tax category can be performed as expected. 

### TSE disconnecting from POS PRO

`Build 6.38.224: DS-3876`

**Issue**  
Company locations using POS PRO in conjunction with a fiscal Technical Security Device (TSE) could encounter the issue where the TSE would disconnect if POS PRO hadn’t been used for more than five minutes since the last transaction. That resulted in the **Fiscal system is not connected; check device** error upon starting a new transaction.

**Resolution**  
The issue has been fixed. Now, the TSE stays connected even if POS PRO has been inactive for a period of time.

### Drawer Memo: Incorrect default state of the Print Start of Day switch

`Build 6.38.225: DS-4047`

Prior to version 6.38.225, the **Print Start of Day** switch available in POS under `Drawer Memo > Start of Day > COMPLETE – Summary` failed to work as expected. In particular, if the user turned on the switch and then completed Start of Day, when the **COMPLETE – Summary** area was opened next time, the switch was turned off.

The issue has been fixed. Now, as expected, the default state of the **Print Start of Day** switch is based on whether it was turned on or off during the last Start of Day.  

